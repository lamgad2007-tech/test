<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Score - Ù†ØªØ§Ø¦Ø¬ Ù…Ø¨Ø§Ø´Ø±Ø©</title>
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Tailwind CSS Ù„Ù„ØªØµÙ…ÙŠÙ… -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Roboto+Mono&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .live-indicator { animation: pulse 1.5s infinite; }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        /* For welcome message */
        #welcome-text.typing::after {
            content: 'â–ˆ';
            animation: blink 1s step-end infinite;
            color: #22c55e; /* green-500 */
            margin-right: 0.25rem;
        }
        @keyframes blink {
            50% { opacity: 0; }
        }
    </style>
</head>
<body class="bg-black text-white min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-900 via-black to-black selection:bg-green-500 selection:text-black">

    <!-- Welcome Overlay -->
    <div id="welcome-overlay" class="fixed inset-0 z-[100] flex flex-col items-center justify-center transition-opacity duration-1000 bg-cover bg-center" style="background-image: url('https://images.pexels.com/photos/46798/the-ball-stadion-football-the-pitch-46798.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1');">
        <!-- Ø·Ø¨Ù‚Ø© Ù…Ø¹ØªÙ…Ø© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© -->
        <div class="absolute inset-0 bg-black/75 backdrop-blur-sm"></div>

        <p id="welcome-text" class="relative z-10 text-2xl md:text-4xl font-bold text-green-500 text-center px-4 font-mono min-h-[40px]"></p>
        <button id="start-button" class="relative z-10 mt-8 bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-all duration-300 text-lg shadow-lg shadow-green-900/40 animate-pulse">
            Ø§Ø¨Ø¯Ø£
        </button>
        <audio id="typing-sound" src="typing.mp3" loop class="relative z-10"></audio>
        <audio id="goal-sound" src="goal_sound.mp3"></audio> <!-- ØµÙˆØª Ø§Ù„Ù‡Ø¯Ù -->
    </div>

    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <header class="bg-black/50 backdrop-blur-md p-4 shadow-2xl border-b border-white/10 sticky top-0 z-40">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <h1 class="text-2xl font-bold text-green-500 hidden md:block">âš½test</h1>
                <h1 class="text-xl font-bold text-green-500 md:hidden">âš½</h1>
                
                <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« -->
                <div class="relative">
                    <input type="text" id="team-search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙØ±ÙŠÙ‚..." class="bg-white/10 border border-white/10 text-white text-sm rounded-full px-4 py-1.5 focus:outline-none focus:ring-2 focus:ring-green-500/50 w-40 md:w-64 transition-all placeholder-gray-500" oninput="handleSearchInput(this.value)" onkeydown="handleSearchEnter(event, this.value)">
                    <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© -->
                    <div id="search-results-dropdown" class="absolute top-full right-0 w-full bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-lg shadow-2xl mt-2 hidden z-50 max-h-60 overflow-y-auto"></div>
                </div>
            </div>
            <div id="connection-status" class="text-xs px-2 py-1 rounded bg-red-500 whitespace-nowrap">ØºÙŠØ± Ù…ØªØµÙ„</div>
        </div>
    </header>

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª -->
    <main class="container mx-auto p-4 mt-6">
        <div id="main-controls" class="flex justify-between items-center mb-4">
            <div class="flex items-center gap-4">
                <h2 id="league-title" class="text-xl border-r-4 border-green-500 pr-3">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø§Ù„Ù…Ù…ØªØ§Ø²</h2>
                <button onclick="refreshMatches()" class="text-sm bg-white/5 hover:bg-white/10 text-white px-3 py-1 rounded border border-white/10 transition backdrop-blur-sm flex items-center gap-2"><span>ğŸ”„</span> ØªØ­Ø¯ÙŠØ«</button>
                <button onclick="openStandings()" class="text-sm bg-white/5 hover:bg-white/10 text-white px-3 py-1 rounded border border-white/10 transition backdrop-blur-sm">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨</button>
                <button onclick="openTopScorers()" class="text-sm bg-white/5 hover:bg-white/10 text-white px-3 py-1 rounded border border-white/10 transition backdrop-blur-sm">âš½ Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ†</button>
            </div>
            
            <div>
                <select id="league-selector" class="bg-white/10 border border-white/10 text-white text-sm rounded-lg focus:ring-green-500/50 focus:border-green-500 block w-full p-2.5 backdrop-blur-sm [&>option]:bg-black">
                    <option value="ALL">ÙƒÙ„ Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª</option>
                    <option value="PL" selected>Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
                    <option value="PD">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ</option>
                    <option value="BL1">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ</option>
                    <option value="FL1">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ</option>
                    <option value="SA">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ</option>
                    <option value="CL">Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§</option>
                    <option value="ELC">Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                    <option value="DED">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù‡ÙˆÙ„Ù†Ø¯ÙŠ</option>
                    <option value="PPL">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¨Ø±ØªØºØ§Ù„ÙŠ</option>
                    <option value="BSA">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ</option>
                </select>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„ØªØµÙÙŠØ© -->
        <div id="filter-tabs" class="flex justify-center mb-6 gap-2 text-sm md:text-base">
            <button id="tab-all" onclick="setFilter('ALL')" class="px-4 py-2 rounded-lg bg-green-600 text-white font-bold transition shadow-lg shadow-green-900/20">Ø§Ù„ÙƒÙ„</button>
            <button id="tab-live" onclick="setFilter('LIVE')" class="px-4 py-2 rounded-lg bg-white/5 border border-white/5 text-gray-300 hover:bg-white/10 transition backdrop-blur-sm">Ù…Ø¨Ø§Ø´Ø±</button>
            <button id="tab-ft" onclick="setFilter('FT')" class="px-4 py-2 rounded-lg bg-white/5 border border-white/5 text-gray-300 hover:bg-white/10 transition backdrop-blur-sm">Ù…Ù†ØªÙ‡ÙŠØ©</button>
            <button id="tab-upcoming" onclick="setFilter('UPCOMING')" class="px-4 py-2 rounded-lg bg-white/5 border border-white/5 text-gray-300 hover:bg-white/10 transition backdrop-blur-sm">Ù‚Ø§Ø¯Ù…Ø©</button>
        </div>

        <div id="matches-container" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
            <!-- Ø³ÙŠØªÙ… Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            <div class="text-center text-gray-500 col-span-full">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</div>
        </div>

        <!-- ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ±ÙŠÙ‚ (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
        <div id="team-page" class="hidden">
            <button onclick="closeTeamPage()" class="mb-4 flex items-center text-green-400 hover:text-green-300 transition">
                <span class="text-2xl ml-2">â†</span> Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
            </button>
            
            <h3 class="text-xl font-bold mb-4 border-r-4 border-blue-500 pr-3">Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
            <div id="team-upcoming-container" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3 mb-8">
                <div class="text-gray-500">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
            </div>

            <h3 class="text-xl font-bold mb-4 border-r-4 border-gray-500 pr-3">Ø¢Ø®Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
            <div id="team-finished-container" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                <div class="text-gray-500">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨ (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
        <div id="standings-page" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <button onclick="closeStandings()" class="flex items-center text-green-400 hover:text-green-300 transition">
                    <span class="text-2xl ml-2">â†</span> Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
                </button>
                <button onclick="refreshStandings()" class="text-sm bg-white/10 hover:bg-white/20 text-white px-3 py-1 rounded border border-white/10 transition backdrop-blur-sm flex items-center gap-2">
                    <span>ğŸ”„</span> ØªØ­Ø¯ÙŠØ«
                </button>
            </div>
            
            <div class="overflow-x-auto bg-white/5 backdrop-blur-md rounded-xl shadow-2xl border border-white/10">
                <table class="w-full text-sm text-right text-gray-400">
                    <thead class="text-xs text-gray-300 uppercase bg-black/40">
                        <tr>
                            <th scope="col" class="px-4 py-3">#</th>
                            <th scope="col" class="px-4 py-3">Ø§Ù„ÙØ±ÙŠÙ‚</th>
                            <th scope="col" class="px-4 py-3 text-center">Ù„Ø¹Ø¨</th>
                            <th scope="col" class="px-4 py-3 text-center">Ù</th>
                            <th scope="col" class="px-4 py-3 text-center">Øª</th>
                            <th scope="col" class="px-4 py-3 text-center">Ø®</th>
                            <th scope="col" class="px-4 py-3 text-center">+/-</th>
                            <th scope="col" class="px-4 py-3 text-center">Ù†Ù‚Ø§Ø·</th>
                        </tr>
                    </thead>
                    <tbody id="standings-body"></tbody>
                </table>
            </div>
        </div>

        <!-- ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
        <div id="player-page" class="hidden">
            <button onclick="closePlayerPage()" class="mb-4 flex items-center text-green-400 hover:text-green-300 transition">
                <span class="text-2xl ml-2">â†</span> Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
            </button>
            
            <div class="bg-white/5 backdrop-blur-md rounded-xl shadow-2xl border border-white/10 p-8 flex flex-col md:flex-row items-center gap-8 relative overflow-hidden">
                <!-- Ø®Ù„ÙÙŠØ© Ø¬Ù…Ø§Ù„ÙŠØ© -->
                <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-green-500/10 to-transparent pointer-events-none"></div>

                <!-- ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ -->
                <div class="relative z-10">
                    <img id="player-image" src="" class="w-32 h-32 rounded-full border-4 border-green-500 object-cover shadow-lg bg-gray-800">
                    <div id="player-shirt-number" class="absolute -bottom-2 -right-2 bg-black text-white font-bold w-10 h-10 flex items-center justify-center rounded-full border-2 border-green-500 hidden"></div>
                </div>
                
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ -->
                <div class="flex-1 text-center md:text-right space-y-4 z-10">
                    <h2 id="player-name" class="text-3xl font-bold text-white"></h2>
                    <div class="flex flex-wrap justify-center md:justify-start gap-4">
                        <div class="bg-white/10 px-4 py-2 rounded-lg border border-white/5">
                            <span class="block text-xs text-gray-400 mb-1">Ø§Ù„Ù…Ø±ÙƒØ²</span>
                            <span id="player-position" class="font-bold text-green-400"></span>
                        </div>
                        <div class="bg-white/10 px-4 py-2 rounded-lg border border-white/5">
                            <span class="block text-xs text-gray-400 mb-1">Ø§Ù„Ø¹Ù…Ø±</span>
                            <span id="player-age" class="font-bold text-white"></span>
                        </div>
                        <div class="bg-white/10 px-4 py-2 rounded-lg border border-white/5">
                            <span class="block text-xs text-gray-400 mb-1">Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</span>
                            <span id="player-nationality" class="font-bold text-white"></span>
                        </div>
                    </div>
                </div>

                <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ³Ù… (Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©) -->
                <div class="bg-black/40 p-6 rounded-xl border border-white/10 min-w-[150px] text-center z-10 backdrop-blur-sm">
                    <div class="text-5xl font-black text-green-500 mb-2 drop-shadow-lg" id="player-goals"></div>
                    <div class="text-sm text-gray-300 font-bold">Ø£Ù‡Ø¯Ø§Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ³Ù…</div>
                    <div class="mt-3 pt-3 border-t border-white/10">
                        <span id="player-assists" class="font-bold text-white text-xl"></span> <span class="text-xs text-gray-500">ØµÙ†Ø§Ø¹Ø©</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ† (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
        <div id="top-scorers-page" class="hidden">
            <button onclick="closeTopScorers()" class="mb-4 flex items-center text-green-400 hover:text-green-300 transition">
                <span class="text-2xl ml-2">â†</span> Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
            </button>
            
            <div class="overflow-x-auto bg-white/5 backdrop-blur-md rounded-xl shadow-2xl border border-white/10">
                <table class="w-full text-sm text-right text-gray-400">
                    <thead class="text-xs text-gray-300 uppercase bg-black/40">
                        <tr>
                            <th scope="col" class="px-4 py-3">#</th>
                            <th scope="col" class="px-4 py-3">Ø§Ù„Ù„Ø§Ø¹Ø¨</th>
                            <th scope="col" class="px-4 py-3">Ø§Ù„ÙØ±ÙŠÙ‚</th>
                            <th scope="col" class="px-4 py-3 text-center">Ø£Ù‡Ø¯Ø§Ù</th>
                            <th scope="col" class="px-4 py-3 text-center">ØµÙ†Ø§Ø¹Ø©</th>
                        </tr>
                    </thead>
                    <tbody id="top-scorers-body"></tbody>
                </table>
            </div>
        </div>
    </main>

    <script>
        const socket = io();

        // --- Welcome Animation ---
        document.addEventListener('DOMContentLoaded', () => {
            const welcomeOverlay = document.getElementById('welcome-overlay');
            const welcomeTextEl = document.getElementById('welcome-text');
            const startButton = document.getElementById('start-button');
            const welcomeMessage = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª";
            
            // Check if the animation has been played in this session
            if (sessionStorage.getItem('welcomeShown')) {
                welcomeOverlay.style.display = 'none';
                return;
            }

            // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù†Øµ ÙØ§Ø±Øº ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            welcomeTextEl.innerHTML = '';

            function typeWriter(text, i, onComplete) {
                if (i < text.length) {
                    welcomeTextEl.innerHTML = text.substring(0, i + 1);
                    setTimeout(() => { typeWriter(text, i + 1, onComplete); }, 100); // Typing speed
                } else if (typeof onComplete === 'function') {
                    welcomeTextEl.classList.remove('typing'); // Remove cursor
                    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
                    const audio = document.getElementById('typing-sound');
                    if (audio) {
                        audio.pause();
                        audio.currentTime = 0;
                    }
                    setTimeout(onComplete, 1500); // Wait after typing
                }
            }

            // Function to start animation after user interaction (required for audio)
            const startAnimation = () => {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
                if (startButton) {
                    startButton.style.display = 'none';
                }
                
                // ØªØ´ØºÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØµÙˆØª
                const audio = document.getElementById('typing-sound');
                if (audio) {
                    audio.volume = 0.6; // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª
                    audio.play().catch(e => console.log("Audio play failed:", e));
                }

                welcomeTextEl.classList.add('typing');
                typeWriter(welcomeMessage, 0, () => {
                    setTimeout(() => {
                        welcomeOverlay.style.opacity = '0';
                        setTimeout(() => { welcomeOverlay.style.display = 'none'; sessionStorage.setItem('welcomeShown', 'true'); }, 1000);
                    }, 1000);
                });
            };

            // Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø« Ø¨Ø§Ù„Ø²Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
            if (startButton) {
                startButton.addEventListener('click', startAnimation);
            }
        });

        const container = document.getElementById('matches-container');
        const statusBadge = document.getElementById('connection-status');
        const leagueSelector = document.getElementById('league-selector');

        let allMatches = [];
        let previousScores = {}; // Ù„ØªØªØ¨Ø¹ ØªØºÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
        let currentFilter = 'ALL';
        let searchQuery = '';
        let currentScorers = []; // Ù„ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ†

        // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        const savedLeague = localStorage.getItem('selectedLeague');
        if (savedLeague) {
            leagueSelector.value = savedLeague;
        }

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
        socket.on('connect', () => {
            statusBadge.textContent = 'Ù…ØªØµÙ„ Ù…Ø¨Ø§Ø´Ø±';
            statusBadge.className = 'text-xs px-2 py-1 rounded bg-green-600';
            
            // Ø·Ù„Ø¨ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
            if (savedLeague) {
                socket.emit('change_league', savedLeague);
            }
        });

        socket.on('disconnect', () => {
            statusBadge.textContent = 'Ø§Ù†Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„';
            statusBadge.className = 'text-xs px-2 py-1 rounded bg-red-600';
        });

        // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
        socket.on('updateMatches', (matches) => {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø£Ù‡Ø¯Ø§Ù Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª (Ù…ÙŠØ²Ø© 365scores)
            let goalScored = false;
            matches.forEach(match => {
                const matchId = match.id;
                const currentScore = (match.homeScore || 0) + (match.awayScore || 0);
                
                if (previousScores[matchId] !== undefined && currentScore > previousScores[matchId]) {
                    goalScored = true;
                }
                previousScores[matchId] = currentScore;
            });

            if (goalScored) {
                const goalAudio = document.getElementById('goal-sound');
                if (goalAudio) goalAudio.play().catch(e => console.log('Autoplay blocked'));
            }

            allMatches = matches;
            
            if (allMatches.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 col-span-full">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ±ÙŠ.</div>';
                return;
            }

            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±ÙŠ
            if (leagueSelector.value === 'ALL') {
                document.getElementById('league-title').textContent = "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª";
            } else {
                document.getElementById('league-title').textContent = allMatches[0].league;
            }
            
            renderMatches();
        });

        function renderMatches() {
            let filtered = allMatches;
            if (currentFilter === 'LIVE') filtered = allMatches.filter(m => m.status === 'LIVE');
            if (currentFilter === 'FT') filtered = allMatches.filter(m => m.status === 'FT');
            if (currentFilter === 'UPCOMING') filtered = allMatches.filter(m => m.status !== 'LIVE' && m.status !== 'FT');

            // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ù„ÙŠ
            if (searchQuery) {
                filtered = filtered.filter(m => m.home.toLowerCase().includes(searchQuery.toLowerCase()) || m.away.toLowerCase().includes(searchQuery.toLowerCase()));
            }

            container.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª
            
            if (filtered.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 col-span-full">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.</div>';
                return;
            }

            // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©
            const createMatchCard = (match) => {
                const isLive = match.status === 'LIVE';
                const timeClass = isLive ? 'text-green-400 live-indicator' : 'text-gray-400';
                
                let timeDisplay;
                if (match.status === 'LIVE') {
                    if (match.minute === 'HT') {
                        timeDisplay = "Ø§Ø³ØªØ±Ø§Ø­Ø©";
                    } else {
                        timeDisplay = match.minute ? match.minute + "'" : "Ù…Ø¨Ø§Ø´Ø±";
                    }
                } else if (match.status === 'FT') {
                    timeDisplay = "FT";
                } else {
                    timeDisplay = `<span class="countdown-timer font-mono text-yellow-400 text-sm" data-timestamp="${match.utcDate}">...</span>`;
                }
                
                // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ù†Ù‚Ø§Ø· Ø§Ù„Ù„ÙŠØ§Ù‚Ø©
                const renderFormDots = (form) => {
                    return `<div class="flex gap-1 justify-center mt-2 opacity-80">
                        ${form.map(r => `<span class="w-1.5 h-1.5 rounded-full ${r==='W'?'bg-green-500 shadow-[0_0_5px_theme(colors.green.500)]':(r==='D'?'bg-gray-500':'bg-red-500')}"></span>`).join('')}
                    </div>`;
                };

                // Ø´Ø±ÙŠØ· Ø§Ù„Ø²Ø®Ù… Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
                const momentumBar = isLive ? `
                    <div class="absolute bottom-4 left-0 w-full text-center pointer-events-none">
                        <span class="text-[10px] text-gray-400 uppercase tracking-wider">Ø³ÙŠØ·Ø±Ø© ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</span>
                    </div>
                    <div class="absolute bottom-0 left-0 w-full h-1.5 flex" title="Ù…Ø¤Ø´Ø± Ø§Ù„Ø²Ø®Ù…">
                        <div class="bg-green-500 opacity-70 h-full transition-all duration-1000 ease-in-out" style="width: ${match.momentum.home}%"></div>
                        <div class="bg-blue-500 opacity-70 h-full transition-all duration-1000 ease-in-out" style="width: ${match.momentum.away}%"></div>
                    </div>
                ` : `
                    <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-transparent via-green-500 to-transparent transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500"></div>
                `;

                return `
                <div onclick="openModal(${match.id})" class="bg-white/5 backdrop-blur-sm rounded-xl p-6 shadow-xl hover:shadow-green-900/20 hover:scale-[1.02] hover:border-green-500/50 cursor-pointer transition duration-500 border border-white/10 relative group overflow-hidden">
                    <div class="text-xs text-gray-400 text-center mb-4 uppercase tracking-wider">${match.league}</div>
                    
                    <div class="flex justify-between items-center">
                        <div class="text-center w-1/3 flex flex-col items-center cursor-pointer hover:opacity-80 transition group-hover:scale-110 duration-300" onclick="event.stopPropagation(); openTeamPage(${match.homeTeamId})">
                            <img src="${match.homeLogo}" class="w-12 h-12 mb-2 object-contain drop-shadow-lg" alt="${match.home}">
                            <div class="font-bold text-lg">${match.home}</div>
                            ${renderFormDots(match.form.home)}
                        </div>
                        <div class="text-center w-1/3">
                            <div class="text-3xl font-black bg-black/50 py-2 px-4 rounded-lg inline-block border border-white/10 shadow-inner">
                                ${match.homeScore} - ${match.awayScore}
                            </div>
                            <div class="mt-2 text-sm font-mono ${timeClass}">
                                ${timeDisplay}
                            </div>
                        </div>
                        <div class="text-center w-1/3 flex flex-col items-center cursor-pointer hover:opacity-80 transition" onclick="event.stopPropagation(); openTeamPage(${match.awayTeamId})">
                            <img src="${match.awayLogo}" class="w-12 h-12 mb-2 object-contain drop-shadow-lg" alt="${match.away}">
                            <div class="font-bold text-lg">${match.away}</div>
                            ${renderFormDots(match.form.away)}
                        </div>
                    </div>
                    ${momentumBar}
                </div>
                `;
            };

            const isAllLeagues = document.getElementById('league-selector').value === 'ALL';

            if (isAllLeagues) {
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±ÙŠ
                const leagues = {};
                filtered.forEach(match => {
                    if (!leagues[match.league]) leagues[match.league] = [];
                    leagues[match.league].push(match);
                });

                Object.keys(leagues).forEach(leagueName => {
                    container.innerHTML += `
                        <div class="col-span-full mt-6 mb-2 border-b border-white/10 pb-2 flex items-center gap-2">
                             <div class="w-1 h-6 bg-green-500 rounded-full"></div>
                             <h3 class="text-xl font-bold text-green-400">${leagueName}</h3>
                        </div>
                    `;
                    leagues[leagueName].forEach(match => {
                        container.innerHTML += createMatchCard(match);
                    });
                });
            } else {
                filtered.forEach(match => {
                    container.innerHTML += createMatchCard(match);
                });
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙˆØ±Ø§Ù‹
            updateCountdowns();
        }

        // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨Ø­Ø« ---
        function handleSearchInput(query) {
            searchQuery = query;
            // ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© ÙÙˆØ±Ø§Ù‹
            renderMatches();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Øµ ÙØ§Ø±ØºØ§Ù‹
            const dropdown = document.getElementById('search-results-dropdown');
            if (!query) {
                dropdown.classList.add('hidden');
            }
        }

        function handleSearchEnter(event, query) {
            if (event.key === 'Enter' && query.length > 2) {
                // Ø·Ù„Ø¨ Ø¨Ø­Ø« Ø´Ø§Ù…Ù„ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
                const dropdown = document.getElementById('search-results-dropdown');
                dropdown.innerHTML = '<div class="p-3 text-center text-gray-400 text-xs">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
                dropdown.classList.remove('hidden');
                socket.emit('search_team', query);
            }
        }

        socket.on('search_team_results', (teams) => {
            const dropdown = document.getElementById('search-results-dropdown');
            dropdown.innerHTML = '';
            
            if (teams.length === 0) {
                dropdown.innerHTML = '<div class="p-3 text-center text-gray-400 text-xs">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙØ±Ù‚</div>';
            } else {
                teams.forEach(team => {
                    dropdown.innerHTML += `
                        <div class="flex items-center gap-3 p-3 hover:bg-white/10 cursor-pointer transition border-b border-white/5 last:border-0" onclick="openTeamPage(${team.id}); document.getElementById('search-results-dropdown').classList.add('hidden');">
                            <img src="${team.crest}" class="w-6 h-6 object-contain">
                            <span class="text-sm font-bold">${team.shortName || team.name}</span>
                        </div>
                    `;
                });
            }
            dropdown.classList.remove('hidden');
        });

        // --- Ø¯ÙˆØ§Ù„ ØµÙØ­Ø© Ø§Ù„ÙØ±ÙŠÙ‚ ---
        function openTeamPage(teamId) {
            if (!teamId) return;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ¥Ø¸Ù‡Ø§Ø± ØµÙØ­Ø© Ø§Ù„ÙØ±ÙŠÙ‚
            document.getElementById('matches-container').classList.add('hidden');
            document.getElementById('main-controls').classList.add('hidden');
            document.getElementById('filter-tabs').classList.add('hidden');
            document.getElementById('standings-page').classList.add('hidden');
            document.getElementById('top-scorers-page').classList.add('hidden');
            document.getElementById('player-page').classList.add('hidden');
            document.getElementById('team-page').classList.remove('hidden');
            
            // ØªÙØ±ÙŠØº Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø¯ÙŠÙ…
            document.getElementById('team-upcoming-container').innerHTML = '<div class="text-center col-span-full text-gray-400">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
            document.getElementById('team-finished-container').innerHTML = '<div class="text-center col-span-full text-gray-400">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';

            // Ø·Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
            socket.emit('get_team_details', teamId);
        }

        function closeTeamPage() {
            document.getElementById('team-page').classList.add('hidden');
            document.getElementById('matches-container').classList.remove('hidden');
            document.getElementById('main-controls').classList.remove('hidden');
            document.getElementById('filter-tabs').classList.remove('hidden');
        }

        socket.on('team_details_response', (data) => {
            const renderTeamMatches = (matches, containerId) => {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                if (matches.length === 0) {
                    container.innerHTML = '<div class="text-gray-500 col-span-full">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª.</div>';
                    return;
                }
                matches.forEach(match => {
                    const date = new Date(match.utcDate);
                    const dateStr = date.toLocaleDateString('en-GB', {day: '2-digit', month: '2-digit'});
                    
                    container.innerHTML += `
                        <div class="bg-white/5 backdrop-blur-sm rounded-lg p-4 border border-white/10 flex justify-between items-center hover:bg-white/10 transition">
                            <div class="flex flex-col items-center w-1/3">
                                <img src="${match.homeLogo}" class="w-8 h-8 mb-1 object-contain">
                                <span class="text-xs font-bold text-center">${match.home}</span>
                            </div>
                            <div class="flex flex-col items-center w-1/3">
                                <span class="text-xs text-gray-400 mb-1">${dateStr}</span>
                                <span class="bg-black/50 px-3 py-1 rounded font-bold border border-white/10">
                                    ${match.status === 'SCHEDULED' ? 'VS' : match.homeScore + ' - ' + match.awayScore}
                                </span>
                            </div>
                            <div class="flex flex-col items-center w-1/3">
                                <img src="${match.awayLogo}" class="w-8 h-8 mb-1 object-contain">
                                <span class="text-xs font-bold text-center">${match.away}</span>
                            </div>
                        </div>
                    `;
                });
            };

            renderTeamMatches(data.upcoming, 'team-upcoming-container');
            renderTeamMatches(data.finished, 'team-finished-container');
        });

        // --- Ø¯ÙˆØ§Ù„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨ ---
        function openStandings() {
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
            document.getElementById('matches-container').classList.add('hidden');
            document.getElementById('team-page').classList.add('hidden');
            document.getElementById('filter-tabs').classList.add('hidden');
            document.getElementById('top-scorers-page').classList.add('hidden');
            document.getElementById('player-page').classList.add('hidden');
            
            // Ø¥Ø¸Ù‡Ø§Ø± ØµÙØ­Ø© Ø§Ù„ØªØ±ØªÙŠØ¨
            document.getElementById('standings-page').classList.remove('hidden');
            
            // Ø·Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const league = document.getElementById('league-selector').value;
            document.getElementById('standings-body').innerHTML = '<tr><td colspan="8" class="text-center py-8">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨...</td></tr>';
            socket.emit('get_standings', league);
        }

        function closeStandings() {
            document.getElementById('standings-page').classList.add('hidden');
            document.getElementById('matches-container').classList.remove('hidden');
            document.getElementById('filter-tabs').classList.remove('hidden');
        }

        function refreshMatches() {
            const currentLeague = document.getElementById('league-selector').value;
            container.innerHTML = '<div class="text-center text-gray-500 col-span-full">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</div>';
            socket.emit('change_league', currentLeague);
        }

        function refreshStandings() {
            const league = document.getElementById('league-selector').value;
            const tbody = document.getElementById('standings-body');
            tbody.innerHTML = '<tr><td colspan="8" class="text-center py-8">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</td></tr>';
            socket.emit('get_standings', league);
        }

        socket.on('standings_response', (table) => {
            const tbody = document.getElementById('standings-body');
            tbody.innerHTML = '';
            
            table.forEach(row => {
                let posClass = "text-white";
                let rowStyle = "border-b border-white/5";
                
                if (row.position === 1) {
                    posClass = "text-yellow-400 text-xl drop-shadow-md";
                    rowStyle = "border-b border-yellow-500/30 bg-gradient-to-r from-yellow-500/10 to-transparent";
                } else if (row.position === 2) {
                    posClass = "text-gray-300 text-xl drop-shadow-md";
                    rowStyle = "border-b border-gray-400/30 bg-gradient-to-r from-gray-500/10 to-transparent";
                } else if (row.position === 3) {
                    posClass = "text-amber-600 text-xl drop-shadow-md";
                    rowStyle = "border-b border-orange-500/30 bg-gradient-to-r from-orange-500/10 to-transparent";
                }

                // ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØºÙŠØ±
                let trendIcon = '<span class="text-gray-600 text-[10px] ml-1">â€¢</span>'; // Ø«Ø¨Ø§Øª
                if (row.trend === 1) {
                    trendIcon = '<span class="text-green-500 text-[10px] ml-1">â–²</span>'; // ØµØ¹ÙˆØ¯
                } else if (row.trend === -1) {
                    trendIcon = '<span class="text-red-500 text-[10px] ml-1">â–¼</span>'; // Ù‡Ø¨ÙˆØ·
                }

                const tr = `
                    <tr class="${rowStyle} hover:bg-white/10 transition duration-300 cursor-default">
                        <td class="px-4 py-3 font-bold ${posClass}"><div class="flex items-center justify-center gap-1">${row.position} ${trendIcon}</div></td>
                        <td class="px-4 py-3 flex items-center gap-2 font-medium text-white cursor-pointer hover:text-green-400" onclick="openTeamPage(${row.team.id})">
                            <img src="${row.team.crest}" class="w-6 h-6 object-contain"> ${row.team.shortName || row.team.name}
                        </td>
                        <td class="px-4 py-3 text-center">${row.playedGames}</td>
                        <td class="px-4 py-3 text-center text-green-400">${row.won}</td>
                        <td class="px-4 py-3 text-center text-yellow-400">${row.draw}</td>
                        <td class="px-4 py-3 text-center text-red-400">${row.lost}</td>
                        <td class="px-4 py-3 text-center" dir="ltr">${row.goalDifference > 0 ? '+' + row.goalDifference : row.goalDifference}</td>
                        <td class="px-4 py-3 text-center font-bold text-white text-lg">${row.points || 0}</td>
                    </tr>
                `;
                tbody.innerHTML += tr;
            });
        });

        // --- Ø¯ÙˆØ§Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ† ---
        function openTopScorers() {
            document.getElementById('matches-container').classList.add('hidden');
            document.getElementById('team-page').classList.add('hidden');
            document.getElementById('filter-tabs').classList.add('hidden');
            document.getElementById('standings-page').classList.add('hidden');
            document.getElementById('player-page').classList.add('hidden');

            document.getElementById('top-scorers-page').classList.remove('hidden');

            const league = document.getElementById('league-selector').value;
            document.getElementById('top-scorers-body').innerHTML = '<tr><td colspan="5" class="text-center py-8">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ†...</td></tr>';
            socket.emit('get_top_scorers', league);
        }

        function closeTopScorers() {
            document.getElementById('top-scorers-page').classList.add('hidden');
            document.getElementById('matches-container').classList.remove('hidden');
            document.getElementById('filter-tabs').classList.remove('hidden');
        }

        socket.on('top_scorers_response', (scorers) => {
            currentScorers = scorers; // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const tbody = document.getElementById('top-scorers-body');
            tbody.innerHTML = '';
            
            scorers.forEach((scorer, index) => {
                const tr = `
                    <tr class="border-b border-white/5 hover:bg-white/10 transition duration-300 cursor-default group">
                        <td class="px-4 py-3 font-bold text-white">${index + 1}</td>
                        <td class="px-4 py-3 font-medium text-white cursor-pointer hover:text-green-400 underline decoration-dotted underline-offset-4" onclick="openPlayerPage(${scorer.player.id})">${scorer.player.name}</td>
                        <td class="px-4 py-3 flex items-center gap-2 cursor-pointer hover:text-green-400" onclick="openTeamPage(${scorer.team.id})">
                            <img src="${scorer.team.crest}" class="w-6 h-6 object-contain"> ${scorer.team.shortName || scorer.team.name}
                        </td>
                        <td class="px-4 py-3 text-center font-bold text-green-400 text-lg">${scorer.goals}</td>
                        <td class="px-4 py-3 text-center text-gray-400">${scorer.assists !== null ? scorer.assists : '-'}</td>
                    </tr>
                `;
                tbody.innerHTML += tr;
            });
        });

        // --- Ø¯ÙˆØ§Ù„ ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ ---
        function openPlayerPage(playerId) {
            // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹
            const scorerData = currentScorers.find(s => s.player.id === playerId);
            if (!scorerData) return;

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
            document.getElementById('top-scorers-page').classList.add('hidden');
            document.getElementById('player-page').classList.remove('hidden');

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© (Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©)
            document.getElementById('player-name').textContent = scorerData.player.name;
            document.getElementById('player-goals').textContent = scorerData.goals;
            document.getElementById('player-assists').textContent = scorerData.assists || 0;
            document.getElementById('player-position').textContent = scorerData.player.position || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            
            // ØªØ¹ÙŠÙŠÙ† ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø£Ùˆ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (Ù„Ø£Ù† API Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ Ù„Ø§ ÙŠÙˆÙØ± ØµÙˆØ± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†)
            const photoIndex = playerId % 99;
            document.getElementById('player-image').src = `https://randomuser.me/api/portraits/men/${photoIndex}.jpg`;

            // ØªÙØ±ÙŠØº Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø³ØªØ£ØªÙŠ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
            document.getElementById('player-age').textContent = '...';
            document.getElementById('player-nationality').textContent = '...';
            document.getElementById('player-shirt-number').classList.add('hidden');

            // Ø·Ù„Ø¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
            socket.emit('get_player_details', playerId);
        }

        function closePlayerPage() {
            document.getElementById('player-page').classList.add('hidden');
            document.getElementById('top-scorers-page').classList.remove('hidden');
        }

        socket.on('player_details_response', (player) => {
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±
            if (player.dateOfBirth) {
                const dob = new Date(player.dateOfBirth);
                const diff = Date.now() - dob.getTime();
                const age = Math.floor(diff / (1000 * 60 * 60 * 24 * 365.25));
                document.getElementById('player-age').textContent = age + ' Ø³Ù†Ø©';
            } else {
                document.getElementById('player-age').textContent = 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            }

            document.getElementById('player-nationality').textContent = player.nationality || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            
            if (player.shirtNumber) {
                const shirtBadge = document.getElementById('player-shirt-number');
                shirtBadge.textContent = player.shirtNumber;
                shirtBadge.classList.remove('hidden');
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø±ÙƒØ² Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£Ø¯Ù‚ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
            if (player.position) document.getElementById('player-position').textContent = player.position;
        });

        // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modal) ---
        function openModal(matchId) {
            const match = allMatches.find(m => m.id === matchId);
            if (!match) return;

            const modal = document.getElementById('stats-modal');
            const content = document.getElementById('modal-content');
            
            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('modal-home-logo').src = match.homeLogo;
            document.getElementById('modal-home-name').textContent = match.home;
            document.getElementById('modal-away-logo').src = match.awayLogo;
            document.getElementById('modal-away-name').textContent = match.away;
            document.getElementById('modal-score').textContent = `${match.homeScore} - ${match.awayScore}`;
            
            // --- ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« (Timeline) ---
            const eventsContainer = document.getElementById('modal-events-body');
            if (match.events && match.events.length > 0) {
                let eventsHTML = '<div class="relative border-l-2 border-white/10 ml-4 my-4 space-y-6">';
                match.events.forEach(event => {
                    const isHome = event.team === 'home';
                    
                    let icon = '';
                    if (event.type === 'Goal') {
                        icon = 'âš½';
                    } else if (event.type === 'Card') {
                        icon = event.detail === 'Yellow' ? 'ğŸŸ¨' : 'ğŸŸ¥';
                    }

                    const teamName = isHome ? match.home : match.away;
                    let detailLine;
                    if (event.type === 'Goal') {
                        const teamLogo = isHome ? match.homeLogo : match.awayLogo;
                        detailLine = `
                            <div class="flex items-center gap-1.5 mt-1">
                                <img src="${teamLogo}" class="w-4 h-4 object-contain">
                                <span class="text-xs text-gray-400">${event.player} (${teamName})</span>
                            </div>
                        `;
                    } else {
                        detailLine = `<span class="text-xs text-gray-400 mt-1">${event.player} (${teamName})</span>`;
                    }

                    // ØªØµÙ…ÙŠÙ… ÙŠØ´Ø¨Ù‡ 365scores: Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·ØŒ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„ Ø¨Ø¬Ø§Ù†Ø¨Ù‡
                    eventsHTML += `
                        <div class="relative pl-6">
                            <!-- Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© -->
                            <div class="absolute -left-[9px] top-0 bg-gray-900 border-2 border-green-500 rounded-full w-4 h-4 flex items-center justify-center"></div>
                            
                            <div class="flex items-center gap-3 bg-white/5 p-3 rounded-lg border border-white/5 hover:bg-white/10 transition">
                                <span class="font-mono text-green-500 font-bold w-8 text-center border-l border-white/10 pl-2">${event.minute}'</span>
                                <div class="text-xl">${icon}</div>
                                <div class="flex flex-col">
                                    <span class="text-sm font-bold text-white">${event.type === 'Goal' ? 'Ù‡Ø¯Ù!' : 'Ø¨Ø·Ø§Ù‚Ø© ' + (event.detail === 'Yellow' ? 'ØµÙØ±Ø§Ø¡' : 'Ø­Ù…Ø±Ø§Ø¡')}</span>
                                    ${detailLine}
                                </div>
                            </div>
                        </div>
                    `;
                });
                eventsHTML += '</div>';
                eventsContainer.innerHTML = eventsHTML;
            } else {
                eventsContainer.innerHTML = '<div class="text-center text-gray-500 py-10">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</div>';
            }

            // --- ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ---
            const commentaryContainer = document.getElementById('modal-commentary-body');
            if (match.commentary && match.commentary.length > 0) {
                let commentaryHTML = '<div class="space-y-3 p-4">';
                // Ø¹ÙƒØ³ Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø­Ø¯Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ (Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 90) ÙˆØ§Ù„Ø£Ù‚Ø¯Ù… ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ (Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 1)
                [...match.commentary].reverse().forEach(comment => {
                    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø« (Ø­Ø³Ø§Ø³ÙŠØ© Ø¨ØµØ±ÙŠØ©)
                    let icon = 'ğŸ™ï¸';
                    let borderClass = 'border-transparent';
                    let bgClass = 'hover:bg-white/5';
                    let textClass = 'text-gray-300';

                    if (comment.type === 'Goal') {
                        icon = 'âš½';
                        borderClass = 'border-green-500';
                        bgClass = 'bg-green-500/10 hover:bg-green-500/20';
                        textClass = 'text-white font-bold';
                    } else if (comment.type === 'Card') {
                        icon = comment.detail === 'Yellow' ? 'ğŸŸ¨' : 'ğŸŸ¥';
                        borderClass = comment.detail === 'Yellow' ? 'border-yellow-500' : 'border-red-500';
                        bgClass = comment.detail === 'Yellow' ? 'bg-yellow-500/5 hover:bg-yellow-500/10' : 'bg-red-500/5 hover:bg-red-500/10';
                    }

                    commentaryHTML += `
                        <div class="flex items-start gap-3 text-sm p-3 rounded-lg transition-all duration-300 border-r-4 ${borderClass} ${bgClass}">
                            <div class="flex flex-col items-center min-w-[40px]">
                                <span class="font-mono text-green-500 font-bold text-xs">${comment.minute}'</span>
                                <span class="text-lg mt-1 filter drop-shadow-md hover:scale-110 transition-transform cursor-default" title="${comment.type || 'ØªØ¹Ù„ÙŠÙ‚'}">${icon}</span>
                            </div>
                            <div class="w-px bg-white/10 self-stretch"></div>
                            <p class="${textClass} flex-1 leading-relaxed">${comment.text}</p>
                        </div>
                    `;
                });
                commentaryHTML += '</div>';
                commentaryContainer.innerHTML = commentaryHTML;
            } else {
                commentaryContainer.innerHTML = '<div class="text-center text-gray-500 py-10">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚ Ù…Ø¨Ø§Ø´Ø± Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©.</div>';
            }

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            const statsHTML = `
                <div class="space-y-4 mt-6">
                    <!-- Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª Ø§Ù„ÙÙˆØ² -->
                    <div class="mb-6 bg-white/5 p-3 rounded-lg border border-white/5">
                        <div class="text-xs text-center text-gray-400 mb-2">Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª Ø§Ù„ÙÙˆØ²</div>
                        <div class="flex h-4 rounded-full overflow-hidden text-[10px] font-bold text-black leading-4">
                            <div class="bg-green-500 text-center transition-all duration-1000" style="width: ${match.probabilities.home}%">${match.probabilities.home}%</div>
                            <div class="bg-gray-400 text-center transition-all duration-1000" style="width: ${match.probabilities.draw}%">${match.probabilities.draw}%</div>
                            <div class="bg-blue-500 text-center transition-all duration-1000" style="width: ${match.probabilities.away}%">${match.probabilities.away}%</div>
                        </div>
                        <div class="flex justify-between text-[10px] text-gray-500 mt-1 px-1">
                            <span>${match.home}</span>
                            <span>ØªØ¹Ø§Ø¯Ù„</span>
                            <span>${match.away}</span>
                        </div>
                    </div>

                    <!-- Ø§Ù„Ø§Ø³ØªØ­ÙˆØ§Ø° -->
                    <div>
                        <div class="flex justify-between text-sm text-gray-400 mb-1">
                            <span>${match.statistics.homePossession}%</span>
                            <span>Ø§Ù„Ø§Ø³ØªØ­ÙˆØ§Ø°</span>
                            <span>${match.statistics.awayPossession}%</span>
                        </div>
                        <div class="flex h-2 bg-gray-700 rounded-full overflow-hidden">
                            <div class="bg-green-500 h-full" style="width: ${match.statistics.homePossession}%"></div>
                            <div class="bg-blue-500 h-full" style="width: ${match.statistics.awayPossession}%"></div>
                        </div>
                    </div>

                    <!-- Ø§Ù„ØªØ³Ø¯ÙŠØ¯Ø§Øª -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl">${match.statistics.homeShots}</span>
                        <span class="text-sm text-gray-400">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ³Ø¯ÙŠØ¯Ø§Øª</span>
                        <span class="font-bold text-xl">${match.statistics.awayShots}</span>
                    </div>

                    <!-- Ø§Ù„ØªØ³Ø¯ÙŠØ¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ù…Ù‰ -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl">${match.statistics.homeOnTarget}</span>
                        <span class="text-sm text-gray-400">ØªØ³Ø¯ÙŠØ¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ù…Ù‰</span>
                        <span class="font-bold text-xl">${match.statistics.awayOnTarget}</span>
                    </div>

                    <!-- Ø§Ù„Ø¶Ø±Ø¨Ø§Øª Ø§Ù„Ø±ÙƒÙ†ÙŠØ© -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl">${match.statistics.homeCorners}</span>
                        <span class="text-sm text-gray-400">Ø§Ù„Ø¶Ø±Ø¨Ø§Øª Ø§Ù„Ø±ÙƒÙ†ÙŠØ©</span>
                        <span class="font-bold text-xl">${match.statistics.awayCorners}</span>
                    </div>

                    <!-- Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ³Ù„Ù„ -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl">${match.statistics.homeOffsides}</span>
                        <span class="text-sm text-gray-400">Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ³Ù„Ù„</span>
                        <span class="font-bold text-xl">${match.statistics.awayOffsides}</span>
                    </div>

                    <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl text-red-500">${match.statistics.homeRedCards}</span>
                        <span class="text-sm text-gray-400">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡</span>
                        <span class="font-bold text-xl text-red-500">${match.statistics.awayRedCards}</span>
                    </div>

                    <!-- Ø§Ù„Ù‡Ø¬Ù…Ø§Øª -->
                    <div class="flex justify-between items-center border-b border-white/10 pb-2">
                        <span class="font-bold text-xl">${match.statistics.homeAttacks}</span>
                        <span class="text-sm text-gray-400">Ù‡Ø¬Ù…Ø§Øª</span>
                        <span class="font-bold text-xl">${match.statistics.awayAttacks}</span>
                    </div>
                </div>
            `;
            
            document.getElementById('modal-stats-body').innerHTML = statsHTML;

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„Ø©
            let lineupsHTML = '';
            if (match.lineups && match.lineups.home.length > 0) {
                // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±ÙƒØ²
                const groupPlayers = (players) => ({
                    GK: players.filter(p => p.pos === 'GK'),
                    DF: players.filter(p => p.pos === 'DF'),
                    MF: players.filter(p => p.pos === 'MF'),
                    FW: players.filter(p => p.pos === 'FW')
                });

                const home = groupPlayers(match.lineups.home);
                const away = groupPlayers(match.lineups.away);

                // Ø¯Ø§Ù„Ø© Ù„Ø±Ø³Ù… ØµÙ Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
                const renderRow = (players) => `
                    <div class="flex justify-around w-full px-4">
                        ${players.map(p => `
                            <div class="flex flex-col items-center">
                                <div class="relative">
                                    <img src="${p.photo}" class="w-10 h-10 rounded-full border-2 border-white shadow-sm bg-gray-600 object-cover">
                                    <span class="absolute -bottom-1 -right-1 bg-gray-900 text-white text-[10px] px-1 rounded-full border border-gray-500">${p.number}</span>
                                </div>
                                <span class="text-[10px] text-white font-bold mt-1 bg-black bg-opacity-50 px-1 rounded truncate max-w-[60px]">${p.name}</span>
                            </div>
                        `).join('')}
                    </div>
                `;

                lineupsHTML = `
                    <div class="relative bg-green-600 mx-auto border-4 border-white rounded-lg shadow-inner overflow-hidden" style="height: 600px; max-width: 100%; background-image: linear-gradient(0deg, transparent 49%, rgba(255,255,255,0.3) 49%, rgba(255,255,255,0.3) 51%, transparent 51%);">
                        <!-- Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ù…Ù†ØªØµÙ -->
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-24 h-24 border-2 border-white rounded-full opacity-30"></div>
                        
                        <!-- Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¶ÙŠÙ (ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰) -->
                        <div class="absolute top-0 w-full h-1/2 flex flex-col justify-start pt-4 space-y-6">
                            ${renderRow(away.GK)}
                            ${renderRow(away.DF)}
                            ${renderRow(away.MF)}
                            ${renderRow(away.FW)}
                        </div>

                        <!-- Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¶ÙŠÙ (ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„) -->
                        <div class="absolute bottom-0 w-full h-1/2 flex flex-col justify-end pb-4 space-y-6">
                            ${renderRow(home.FW)}
                            ${renderRow(home.MF)}
                            ${renderRow(home.DF)}
                            ${renderRow(home.GK)}
                        </div>
                    </div>
                `;
            } else {
                lineupsHTML = '<div class="text-center text-gray-500 py-10">Ø§Ù„ØªØ´ÙƒÙŠÙ„Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</div>';
            }
            document.getElementById('modal-lineups-body').innerHTML = lineupsHTML;

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
            switchTab('stats');
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
            modal.classList.remove('hidden');
        }

        // --- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ---
        function updateCountdowns() {
            const timers = document.querySelectorAll('.countdown-timer');
            const now = new Date().getTime();

            timers.forEach(timer => {
                const matchTime = new Date(timer.getAttribute('data-timestamp')).getTime();
                const distance = matchTime - now;

                if (distance < 0) {
                    timer.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø¯Ø¡...";
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                if (days > 0) {
                    timer.innerHTML = `${days} ÙŠÙˆÙ… ${hours} Ø³Ø§Ø¹Ø©`;
                } else {
                    timer.innerHTML = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            });
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
        setInterval(updateCountdowns, 1000);

        function closeModal() {
            document.getElementById('stats-modal').classList.add('hidden');
        }

        function switchTab(tabName) {
            const statsBody = document.getElementById('modal-stats-body');
            const lineupsBody = document.getElementById('modal-lineups-body');
            const tabStats = document.getElementById('tab-stats');
            const tabEvents = document.getElementById('tab-events');
            const tabCommentary = document.getElementById('tab-commentary');
            const tabLineups = document.getElementById('tab-lineups');

            if (tabName === 'stats') {
                statsBody.classList.remove('hidden');
                lineupsBody.classList.add('hidden');
                tabStats.className = "flex-1 py-2 text-center text-green-400 border-b-2 border-green-400 font-bold transition cursor-pointer bg-white/5";
                tabLineups.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabEvents) tabEvents.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabCommentary) tabCommentary.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                document.getElementById('modal-events-body').classList.add('hidden');
                document.getElementById('modal-commentary-body').classList.add('hidden');
            } else if (tabName === 'lineups') {
                statsBody.classList.add('hidden');
                lineupsBody.classList.remove('hidden');
                tabStats.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                tabLineups.className = "flex-1 py-2 text-center text-green-400 border-b-2 border-green-400 font-bold transition cursor-pointer bg-white/5";
                if(tabEvents) tabEvents.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabCommentary) tabCommentary.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                document.getElementById('modal-events-body').classList.add('hidden');
                document.getElementById('modal-commentary-body').classList.add('hidden');
            } else if (tabName === 'events') {
                statsBody.classList.add('hidden');
                lineupsBody.classList.add('hidden');
                document.getElementById('modal-events-body').classList.remove('hidden');
                document.getElementById('modal-commentary-body').classList.add('hidden');
                
                tabStats.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                tabLineups.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabEvents) tabEvents.className = "flex-1 py-2 text-center text-green-400 border-b-2 border-green-400 font-bold transition cursor-pointer bg-white/5";
                if(tabCommentary) tabCommentary.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
            } else if (tabName === 'commentary') {
                statsBody.classList.add('hidden');
                lineupsBody.classList.add('hidden');
                document.getElementById('modal-events-body').classList.add('hidden');
                document.getElementById('modal-commentary-body').classList.remove('hidden');

                tabStats.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                tabLineups.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabEvents) tabEvents.className = "flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5";
                if(tabCommentary) tabCommentary.className = "flex-1 py-2 text-center text-green-400 border-b-2 border-green-400 font-bold transition cursor-pointer bg-white/5";
            }
        }

        function setFilter(filter) {
            currentFilter = filter;
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            const tabs = ['ALL', 'LIVE', 'FT', 'UPCOMING'];
            tabs.forEach(t => {
                const btn = document.getElementById('tab-' + t.toLowerCase());
                if (t === filter) {
                    btn.className = "px-4 py-2 rounded-lg bg-green-600 text-white font-bold transition shadow-lg shadow-green-900/20";
                } else {
                    btn.className = "px-4 py-2 rounded-lg bg-white/5 border border-white/5 text-gray-300 hover:bg-white/10 transition backdrop-blur-sm";
                }
            });

            renderMatches();
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ø§Ù„Ø¯ÙˆØ±ÙŠ Ù„Ù„Ø®Ø§Ø¯Ù…
        leagueSelector.addEventListener('change', (event) => {
            const newLeague = event.target.value;
            localStorage.setItem('selectedLeague', newLeague); // Ø­ÙØ¸ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
            console.log(`ØªØºÙŠÙŠØ± Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø¥Ù„Ù‰: ${newLeague}`);
            socket.emit('change_league', newLeague);
            container.innerHTML = '<div class="text-center text-gray-500 col-span-full">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯...</div>';
        });
    </script>

    <!-- Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modal) -->
    <div id="stats-modal" class="fixed inset-0 bg-black bg-opacity-80 hidden flex items-center justify-center z-50 backdrop-blur-sm" onclick="closeModal()">
        <div class="bg-gray-900/95 backdrop-blur-xl rounded-2xl w-full max-w-lg p-6 m-4 shadow-2xl border border-white/10 transform transition-all scale-100" onclick="event.stopPropagation()">
            
            <!-- Ø±Ø£Ø³ Ø§Ù„Ù†Ø§ÙØ°Ø© -->
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-green-400">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</h3>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>

            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ±ÙŠÙ‚ÙŠÙ† ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© -->
            <div class="flex justify-between items-center mb-8">
                <div class="text-center w-1/3">
                    <img id="modal-home-logo" class="w-16 h-16 mx-auto mb-2 object-contain">
                    <div id="modal-home-name" class="font-bold text-sm"></div>
                </div>
                <div class="text-center w-1/3">
                    <div id="modal-score" class="text-4xl font-black tracking-widest"></div>
                </div>
                <div class="text-center w-1/3">
                    <img id="modal-away-logo" class="w-16 h-16 mx-auto mb-2 object-contain">
                    <div id="modal-away-name" class="font-bold text-sm"></div>
                </div>
            </div>

            <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
            <div class="flex mb-4 border-b border-white/10">
                <div id="tab-stats" onclick="switchTab('stats')" class="flex-1 py-2 text-center text-green-400 border-b-2 border-green-400 font-bold transition cursor-pointer bg-white/5">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
                <div id="tab-events" onclick="switchTab('events')" class="flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5">Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
                <div id="tab-commentary" onclick="switchTab('commentary')" class="flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</div>
                <div id="tab-lineups" onclick="switchTab('lineups')" class="flex-1 py-2 text-center text-gray-400 hover:text-white transition cursor-pointer hover:bg-white/5">Ø§Ù„ØªØ´ÙƒÙŠÙ„Ø©</div>
            </div>

            <!-- Ø¬Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div id="modal-stats-body"></div>
            <!-- Ø¬Ø³Ù… Ø§Ù„Ø£Ø­Ø¯Ø§Ø« -->
            <div id="modal-events-body" class="hidden overflow-y-auto max-h-[70vh]"></div>
            <!-- Ø¬Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± -->
            <div id="modal-commentary-body" class="hidden overflow-y-auto max-h-[70vh]"></div>
            <!-- Ø¬Ø³Ù… Ø§Ù„ØªØ´ÙƒÙŠÙ„Ø© -->
            <div id="modal-lineups-body" class="hidden overflow-y-auto max-h-[70vh]"></div>
        </div>
    </div>
</body>
</html>
